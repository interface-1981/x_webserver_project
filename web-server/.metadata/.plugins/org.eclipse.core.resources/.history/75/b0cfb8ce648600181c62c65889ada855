package template;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;

public class TemplateEngine {

	private static final String LOGIC_TAG_START = "$[";
	private static final String LOGIC_TAG_END = "]$";

	private static final String LOGIC_IF = "IF";
	private static final String LOGIC_FOREACH = "FOREACH";


	private static final String PROPARTY_TAG_START = "@(";
	private static final String PROPARTY_TAG_END = ")@";

	private String templateDir;

	public TemplateEngine(String templateDir) {
		super();
		this.templateDir = templateDir;
	}

	public String parse(String templateFileName, Object context) throws Exception {

		File file = new File (this.templateDir + "/" + templateFileName);
		BufferedReader br = new BufferedReader(new FileReader(file));

		String lineStr = br.readLine();
		while(lineStr != null) {
			if (existsLogicTag(lineStr)) {
				lineStr = replacePropertyTag(lineStr, context);
			}

		}
		return "";
	}

	private boolean existsLogicTag(String str) {

		if (str.indexOf(PROPARTY_TAG_START) >= 0) {
			if (str.indexOf(PROPARTY_TAG_END) >= 0) {
				return true;
			}
		}
		return false;

	}

	private String replacePropertyTag(String str, Object context) {

		int tagStart = str.indexOf(PROPARTY_TAG_START);
		int tagEnd = str.indexOf(PROPARTY_TAG_END) + PROPARTY_TAG_START.length();
		String tag = str.substring(tagStart, tagEnd);
		return str.replace(tag, getProperty(context));

	}

	private String getProperty(Object context) {

		return "";

	}

}
